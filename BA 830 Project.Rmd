---
title: "BA 830 Project"
author: "Team 10"
date: "4/26/2021"
output:
  pdf_document: default
  html_document: default
---
<style type="text/css">

body{ /* Normal  */
      font-size: 12px;
  }
td {  /* Table  */
  font-size: 8px;
}
h1.title {
  font-size: 24px;
  color: DarkRed;
}
h1 { /* Header 1 */
  font-size: 22px;
  color: DarkBlue;
}
h2 { /* Header 2 */
    font-size: 20px;
  color: DarkBlue;
}
h3 { /* Header 3 */
  font-size: 16px;
  font-family: "Times New Roman", Times, serif;
  color: DarkBlue;
}
code.r{ /* Code block */
    font-size: 12px;
}
pre { /* Code block - determines code spacing between lines */
    font-size: 14px;
}
</style>

Team members: Paula Demacker, Yuchen Feng, Leah Fowlkes, Ryan Veytsman, Xinping Yu, Yuzhe Zheng
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(scipen=1, digits=3)
```

```{r, echo=FALSE}
#library
library(data.table)
library(tidyverse)
library(lfe)
library(fixest)
library(lubridate)
library(stargazer)
library(modelsummary)
```

```{r}
#import the file
food <- fread('BA830-Project.csv')
```

```{r}
food %>% mutate (outcome_plate = recode (outcome_plate, '0' = 1, '1' = 0))
```

```{r}
#data cleaning
#gender
food$gender_group[food$Gender == 'Man'] <- 1
food$gender_group[food$Gender == 'Woman'] <- 0
#age
food$age_group[food$Age == '16-25'] <- 1
food$age_group[food$Age == '26-35'] <- 2
food$age_group[food$Age == '36-45'] <- 3
food$age_group[food$Age == '46-55'] <- 4
food$age_group[food$Age == '56-65'] <- 5
#country
food$country_group[food$'Currently living' == 'Europe'] <- 1
food$country_group[food$'Currently living' == 'North America/Central America'] <- 2
food$country_group[food$'Currently living' == 'Asia/Middle east'] <- 3
food$country_group[food$'Currently living' == 'Australia/New Zealand'] <- 4
```

```{r}
#proportion test
prop.test(nrow(food[Treatment ==  1])/10, nrow(food)/10, 0.5)
```
Our group are using simple randomization to select our treatment group and control group. By using the proportion test we can see the p value here is 0.3 which is larger than 0.05, so we fail to reject the null hypothesis and prove that our experiment of treatment and control group was well randomized.

# Randomization / balance check for pre-experiment variables between the treatment and control group.
```{r}
reg.age <- lm(age_group ~ Treatment, data = food)
summary(reg.age)
```

```{r}
reg.gender <- lm(gender_group ~ Treatment, data = food)
summary(reg.gender)
```

```{r}
reg.country <- lm(country_group ~ Treatment, data = food)
summary(reg.country)
```

```{r}
reg.plate <- lm(outcome_plate ~ Treatment, data = food)
summary(reg.plate)
```

```{r}
reg.question <- lm(outcome_question ~ Treatment, data = food)
summary(reg.question)
```

By running regression for all the pre-experiment variables of regression that we select based on our survey, we find out that gender_group and age_group gave us a big p value bigger than 0.05 which is equal to 0.11 and 0.68. In this case, we are not able to reject the null hypothesis. It means that gender_group and age_group are well randomized between treatment group and control group. However, the p value for country_group is smaller than 0.05 which is 0.0096. In this case, we are able to reject the null hypothesis. It means that country_group is not well randomized between treatment group and control group. The reason for that is because we are using simple randomization, and the sample size for some country is not big enough. For example, we might only have one observation from Country A, and based on our simple randomization, it will make our data be bias.

# Regression 
```{r}
together <- feols(c(outcome_plate, outcome_food) ~ Treatment, 
                   data = food, se = 'white')
etable(together)
```
In the regression of model 1 we looked at the outcome_plate as the outcome variable first. We get an intercept of 0.5312, which represents the mean of the outcome of our control group. The estimate for the treatment effect is 0.1737 and has a standard error of 0.0227. Therefore, we have a positive treatment effect which indicates a positive relationship between Treatment and outcome_plate.\
We know from the stars that this result is statistically significant. This means that people in the treatment group are more likely to choose the red plate. 

For model 2 we used outcome_food as our outcome variable. The intercept is 0.4865. Our estimated treatment effect is -0.0828 and has a standard error of 0.0236. This indicates that we have a negative relationship between Treatment and outcome_food. These results are also statistically significant. It still indicates that people in the treatment group are more likely to choose the food on the red plate. The negtaive treatment effect shows us that people in the treatment group are more likely to choose the plate that is positioned on the right. 

```{r}
fixed_effects <- feols(outcome_plate ~ Treatment 
                  | outcome_food + food_name, data = food,
            se = 'white')
etable(fixed_effects)
```
For the regression above we added two fixed effects: outcome_food and food_name to see if the food has an impact on the outcome. The outcome variable is outcome_plate and has an estimated treatment effect of 0.1788 with an standard error of 0.0230, which is really similar to the regression above without the fixed effects. The results of this regression are also statistically significant.  


```{r}
reg.burger <- feols(outcome_plate ~ Treatment, data = food[food_name == 'Burger'])
reg.taco <- feols(outcome_plate ~ Treatment, data = food[food_name == 'Taco'])
reg.friedchicken <- feols(outcome_plate ~ Treatment, data = food[food_name == 'Fried Chicken'])
reg.salmon <- feols(outcome_plate ~ Treatment, data = food[food_name == 'Salmon'])
reg.pasta <- feols(outcome_plate ~ Treatment, data = food[food_name == 'Pasta'])
reg.steak <- feols(outcome_plate ~ Treatment, data = food[food_name == 'Steak'])
reg.dumpling <- feols(outcome_plate ~ Treatment, data = food[food_name == 'Dumpling'])
reg.sushi <- feols(outcome_plate ~ Treatment, data = food[food_name == 'Sushi'])
reg.friedrice <- feols(outcome_plate ~ Treatment, data = food[food_name == 'Fried Rice'])
reg.salad <- feols(outcome_plate ~ Treatment, data = food[food_name == 'Salad'])
etable(reg.burger,reg.taco, reg.friedchicken, reg.salmon, reg.pasta, reg.steak, reg.dumpling, reg.sushi, reg.friedrice, reg.salad)
```
## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
